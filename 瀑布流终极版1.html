<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title>瀑布流终极版</title>
		<style>
			* {
				margin: 0;
				padding: 0;
			}
			
			div {
				margin: 0 auto;
				overflow: hidden;
				box-sizing: border-box;
			}
			
			ul {
				width: 300px;
				margin: 10px;
				float: left;
			}
			
			li {
				list-style: none;
				margin: 5px;
				border: 1px solid blueviolet;
				text-align: center;
				font-size: 50px;
			}
		</style>
		<script>
			window.onload = function() {
				var aUl = [];
				for(var i = 0; i < document.getElementsByTagName('ul').length; i++) {
					aUl.push(document.getElementsByTagName('ul')[i]);
				}
				var n = 0; // 当前加载次数

				createLi();

				window.onscroll = function() {
					//可视区高度
					var clientHeight = document.documentElement.clientHeight;
					//滚动距离
					var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
					//滚动最大高度
					var height = document.body.scrollHeight;
					if(height <= clientHeight + scrollTop + 100) {
						createLi();
					}
				}

				function createLi() {
					var aColor = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22'];

					for(var i = 0; i < 22; i++) {
						var oLi = document.createElement('li');
						oLi.style.height = rnd(100, 300) + 'px';
						oLi.style.background = 'url(images/' + aColor[i] + '.jpg)no-repeat';
						aUl.sort(function(ul1, ul2) {
							return ul1.offsetHeight - ul2.offsetHeight;
						})
						aUl[0].appendChild(oLi);
					}

				}

				function rnd(n, m) {
					return Math.floor(Math.random() * (m - n) + n);
				}

			}
		</script>
	</head>

	<body>
		<div>
			<ul></ul>
			<ul></ul>
			<ul></ul>
		</div>

	</body>

</html>